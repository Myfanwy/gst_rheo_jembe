%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Professional Table
% LaTeX Template
% Version 1.0 (11/10/12)
%
% This template has been downloaded from:
% http://www.LaTeXTemplates.com
%
% License:
% CC BY-NC-SA 3.0 (http://creativecommons.org/licenses/by-nc-sa/3.0/)
%
% Note: to use this table in another LaTeX document, you will need to copy
% the \usepackage{booktabs} line to the new document and paste it before 
% \begin{document}. The table itself can then be pasted anywhere in the new
% document.
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\documentclass{article}

\usepackage{booktabs} % Allows the use of \toprule, \midrule and \bottomrule in tables for horizontal lines
\usepackage[landscape, margin = 0.5in]{geometry} % changes whole document to landscape orientation with 0.5-in margins
\usepackage{longtable} % allows table to go for more than one page
\usepackage{amsmath} % for equations
\usepackage{listings} % for R code
\usepackage{xcolor} % for syntax highlighting
\begin{document}
% Listings Style
\newcommand\mystyle{\lstset{
language = R,
basicstyle = \ttfamily,
commentstyle=\color{gray},
 otherkeywords={map2stan, data},
 keywordstyle=\color{blue}
 }}
 % custom environment for your listings
 \lstnewenvironment{mylist}[1][]
 {
 \mystyle
 \lstset{#1}
 }
 {}
 Experiment 1: Full Model Set and R Specification
%\begin{table} % Add the following just after the closing bracket on this line to specify a position for the table on the page: [h], [t], [b] or [p] - these mean: here, top, bottom and on a separate page, respectively
\begin{longtable}{ l | p{.40\textwidth}| p{.50\textwidth} }
%\sloppy
%\centering % Centers the table on the page, comment out to left-justify
%\begin{tabular}  % The final bracket specifies the number of columns in the table along with left and right borders which are specified using vertical bars (|); each column can be left, right or center-justified using l, r or c. To specify a precise width, use p{width}, e.g. p{5cm}
\toprule % Top horizontal line
Model & Formula & Rstan Code \\ % Column names row
\midrule % In-table horizontal line
m0 & 
$$ Y_i \sim Beta(p_i, \theta) $$
$$ logit(p_i) = \alpha $$
$$ \alpha \sim Normal(0,1) $$
$$ \theta \sim HalfCauchy(1) $$
%begin code - m0
 &
 {\begin{mylist}
# Intercept Model
m0 <- map2stan(
  alist(
    y ~ dbeta2(p,theta),
    logit(p) <- a,
    a ~ dnorm(0, 1),
    theta ~ dcauchy(0,1)
  ),
  data = dlist,
  constraints=list(theta="lower=0"),
  start=list(theta = 1),
  sample=TRUE , warmup=1000 , iter=1e4 , 
  cores=2 , chains=1 )
 \end{mylist}}
 \\ % End Content row 1
 m1 &
 $$ Y_i \sim Beta(p_i, \theta) $$
 $$ logit(p_i) = \alpha_{\textsc{fish}[i]} $$
 $$ \alpha_{\textsc{fish}[i]} \sim Normal(0,1) $$
 $$ \theta \sim HalfCauchy(0, 1) $$
&
% begin code - m1
{\begin{mylist} 
# Fixed effect model: fish
m1 <- map2stan(
  alist(
    y ~ dbeta2(p,theta),
    logit(p) <- a_fish[fish_id],
    a_fish[fish_id] ~ dnorm(0,1),
    theta ~ dcauchy(0,1)
  ),
  data=dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1), warmup=1000 , iter=1e4, cores=2)  \end{mylist}}
\\ % End content Row 2
m2 &
$$ Y_i \sim Beta(p_i, \theta) $$
$$ logit(p_i) = \alpha_{\textsc{fish}[i]} $$
$$ \alpha_{\textsc{fish}[i]} \sim Normal(\alpha,\sigma_\textsc{fish}) $$
$$ \alpha \sim Normal(0,1) $$
$$ \sigma_\textsc{fish} \sim HalfCauchy(0,1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
&
% begin code - m2
{\begin{mylist}
# Varying intercepts: fish
m2 <- map2stan(
  alist(
    y ~ dbeta2(p,theta),
    logit(p) <- a_fish[fish_id],
    a_fish[fish_id] ~ dnorm(a, sigma_fish),
    a ~ dnorm(0, 1),
    sigma_fish ~ dcauchy(0,1),
    theta ~ dcauchy(0,1)
  ),
  data=dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1), warmup=1000 , iter=1e4 , cores=2 ) 
  \end{mylist}}
\\ % End content Row 3
m3 &
$$ Y_i \sim Beta(p_i, \theta) $$
$$ logit(p_i) = \alpha + \alpha_{\textsc{fish}[i]} + \beta_{\textsc{Treatment}_[i]} $$
$$ \alpha_{\textsc{fish}[i]} \sim Normal(0,\sigma_{\textsc{fish}}) $$
$$ \alpha \sim Normal(0, 1) $$
$$ \sigma_{\textsc{fish}} \sim HalfCauchy(0,1) $$
$$ \beta_{\textsc{Treatment}}  \sim Normal(0,1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
&
% begin code - m3
{\begin{mylist}
# varying intercepts for fish by (fixed) treatment effect
m3 <- map2stan(
  alist(
    y ~ dbeta2( p, theta ),
    logit(p) <- a + a_fish[fish_id] + b_treatment*treatment ,
    a_fish[fish_id] ~ dnorm(0, sigma_fish),
    a ~ dnorm(0, 1),
    b_treatment ~ dnorm(0, 1),
    theta ~ dcauchy(0,1),
    sigma_fish ~ dcauchy(0,1)
  ),
  data = dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1), warmup=1000 , iter=1e4 , cores=2 ) \end{mylist}}
\\ % end content row 4
m4 &
$$ Y_i \sim Beta(p_i, \theta) $$
$$ logit(p_i) = \alpha + \alpha_{\textsc{fish}[i]} + \beta_{\textsc{Above}} + \beta_{\textsc{Below}} + \beta_{\textsc{Light}} + \beta_{\textsc{Dark}}$$
$$ \alpha_{\textsc{fish}[i]} \sim Normal(0,\sigma_{\textsc{fish}}) $$
$$ \beta_{\textsc{Above, Below, Light, Dark}} \sim Normal(0, 1) $$
$$ \sigma_{\textsc{fish}} \sim HalfCauchy(0,1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
&
% begin code - m4
{\begin{mylist}
# Varying Intercepts: fish and treatment
m4 <- map2stan(
  alist(
    y ~ dbeta2(p,theta),
    logit(p) <- a_fish[fish_id] + b_above*above + b_below*below 
    + b_light*light + b_dark*dark,   
    a_fish[fish_id] ~ dnorm(0, sigma_fish),
    c(b_above, b_below, b_light, b_dark) ~ dnorm(0, 1),
    sigma_fish ~ dcauchy(0,1),
    theta ~ dcauchy(0,1)
  ),
  data = dlist,
  constraints=list(theta="lower=0"),
  start=list(theta = 1),
  sample=TRUE , warmup=1000 , iter=1e4 , 
  cores=2, chains = 1 )  \end{mylist}} 
\\ % end content row 5
m4.5 &
$$ Y_i \sim Beta(p_i, \theta) $$
$$ logit(p_i) = \alpha + \alpha_{\textsc{fish}[i]} + \alpha_{\textsc{Treatment}_[i]} $$
$$ \alpha_{\textsc{fish}[i]} \sim Normal(0,\sigma_{\textsc{fish}}) $$
$$ \alpha_{\textsc{Treatment}[i]} \sim Normal(0,\sigma_{\textsc{Treatment}}) $$
$$ \alpha \sim Normal(0, 1) $$
$$ \sigma_{\textsc{fish}} \sim HalfCauchy(0,1) $$
$$ \sigma_{\textsc{Treatment}} \sim HalfCauchy(0,1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
&
% begin code - m4
{\begin{mylist}
# Varying Intercepts: fish and treatment (treatment as a mean)
m4.5 <- map2stan(
  alist(
    #likelihood
    y ~ dbeta2( p, theta ),
    # linear model
    logit(p) <- a + a_fish[fish_id] + a_treat[treatment],
    # adaptive priors
    a_fish[fish_id] ~ dnorm(0,sigma_fish),
    a_treat[treatment] ~ dnorm(0, sigma_treat),
    # fixed priors
    a ~ dnorm(0, 1),
    theta ~ dcauchy(0,1),
    sigma_fish ~ dcauchy(0,1),
    sigma_treat ~ dcauchy(0,1)
  ),
  data = dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1), warmup=1000 , iter=1e4 , cores=2 )  \end{mylist}} 
\\ % end content row 5
m5 &
$$ Y_i \sim Beta(p_i, \theta) $$
$$ logit(p_i) = \alpha + \alpha_{\textsc{fish}[i]} + \beta_{\textsc{Velocity}_i} $$
$$ \alpha_{\textsc{fish}[i]} \sim Normal(0,\sigma_{\textsc{fish}}) $$
$$ \alpha \sim Normal(0, 1) $$
$$ \beta_{\textsc{Velocity}} \sim Normal(0, 1) $$
$$ \sigma_{\textsc{fish}} \sim HalfCauchy(0,1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
&
% begin code - m5
{\begin{mylist}
# Varying Intercepts by fish with fixed velocity effect
m5 <- map2stan(
  alist(
    y ~ dbeta2( p, theta ),
    logit(p) <- a + a_fish[fish_id] + b_velocity*vel,
    a_fish[fish_id] ~ dnorm(0, sigma_fish),
    a ~ dnorm(0, 1),
    b_velocity ~ dnorm(0,1),
    theta ~ dcauchy(0,1),
    sigma_fish ~ dcauchy(0,1)
  ),
  data = dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1), warmup=1000 , iter=1e4 , cores=2 )  \end{mylist}} 
\\ % end content row 6
m6 &
$$ Y_i \sim Beta(p_i, \theta) $$
$$ logit(p_i) = \alpha + \alpha_{\textsc{fish}[i]} + \alpha_{\textsc{Velocity}_[i]} $$
$$ \alpha_{\textsc{fish}[i]} \sim Normal(0,\sigma_{\textsc{fish}}) $$
$$ \alpha_{\textsc{Velocity}[i]} \sim Normal(0,\sigma_{\textsc{Velocity}}) $$
$$ \alpha \sim Normal(0, 1) $$
$$ \sigma_{\textsc{fish}} \sim HalfCauchy(0,1) $$
$$ \sigma_{\textsc{Velocity}} \sim HalfCauchy(0, 1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
&
% begin code - m6
{\begin{mylist}
# Varying Intercepts: fish and velocity
m6 <- map2stan(
  alist(
    #likelihood
    y ~ dbeta2( p, theta ),
    # linear model
    logit(p) <- a + a_fish[fish_id] + a_velocity[vel],
    # adaptive priors
    a_fish[fish_id] ~ dnorm(0,sigma_fish),
    a_velocity[vel] ~ dnorm(0, sigma_vel),
    # fixed priors
    a ~ dnorm(0, 1),
    theta ~ dcauchy(0,1),
    sigma_fish ~ dcauchy(0,1),
    sigma_vel ~ dcauchy(0,1)
  ),
  data = dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1), warmup=1000 , iter=1e4 , cores=2 )  \end{mylist}} 
\\ % end content row 6
m7 &
$$ Y_i \sim Beta(p_i, \theta) $$
$$ logit(p_i) = \alpha + \alpha_{\textsc{fish}[i]} + \beta_{\textsc{Velocity}_[i]} + \beta_{\textsc{fishXvelocity}}$$
$$ \alpha_{\textsc{fish}[i]} \sim Normal(0,\sigma_{\textsc{fish}}) $$
$$ \alpha \sim Normal(0, 1) $$
$$ \beta_{\textsc{Velocity}}  \sim Normal(0,1) $$
$$ \beta_{\textsc{fishXvelocity}}  \sim Normal(0,1) $$
$$ \sigma_{\textsc{fish}} \sim HalfCauchy(0,1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
&
% begin code: m7
{\begin{mylist}
# varying intercepts (fish) + 
# fixed effect interaction (fish X velocity)
m7 <- map2stan(
  alist(
    y ~ dbeta2( p, theta ),
    logit(p) <- a + a_fish[fish_id] +  b_velocity*vel + 
    bfXv*fish_id*vel, 
    a_fish[fish_id] ~ dnorm(0, sigma_fish),
    a ~ dnorm(0, 1),
    b_velocity ~ dnorm(0, 1),
    bfXv ~ dnorm(0,1),
    theta ~ dcauchy(0,1),
    sigma_fish ~ dcauchy(0,1)
  ),
  data=dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1) , warmup=1000 , iter=1e4 , cores=2)
   \end{mylist}}
\\ % end content row 7
m1NC &
%logit(p) <- a + a_fish[fish_id] + (b1 + b_fish[fish_id])*velocity
$$ Y_i \sim Beta(p_i, \theta) $$
\small $$ logit(p_i) = \alpha + \alpha_{\textsc{fish}[i]} + \beta_{\textsc{fish}[i]}Velocity_i$$
$$ \alpha \sim Normal(0,10) $$
$$
\begin{bmatrix}
\alpha_{\textsc{fish}} \\
\beta_{\textsc{fish}}
\end{bmatrix} \sim MVNormal \Big(
\begin{bmatrix}
\alpha \\
\beta
\end{bmatrix}, S \Big)
$$
$$
\mathbf{S} = \left( \begin{array}{cc}
\sigma_\alpha & 0 \\
0 & \sigma_\beta
\end{array} \right) R \left( \begin{array}{cc}
\sigma_\alpha & 0 \\
0 & \sigma_\beta
\end{array} \right)
$$
$$ \alpha \sim Normal(0,1) $$
$$ \beta  \sim Normal(0,1) $$
$$ \sigma_{\textsc{fish}} \sim Exp(1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
$$ \rho_{FISH} \sim LKJcorr(2) $$
&
{\begin{mylist}
# Mixed effects model with varying intercepts on fish, 
# varying slopes on fish/velocity
m1NC <- map2stan(
  alist(
    #likelihood
    y ~ dbeta2( p, theta ),
    # linear model
    logit(p) <- a + a_fish[fish_id] + (b_velocity + b_fish)*vel,
    # adaptive non-centered priors 
    c(a_fish, b_fish)[fish_id] ~ dmvnormNC(sigma_fish, Rho_fish),
    # fixed priors
    c(a, b_velocity) ~ dnorm(0,1),
    theta ~ dcauchy(0,1),
    sigma_fish ~ dexp(1),
    Rho_fish ~ dlkjcorr(2)
  ),
  # data
  data=dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1) , warmup=1000 , iter=1e4 ,cores=2 ) \end{mylist}} 
\\ % end content row 8
m2NC &
$$ Y_i \sim Beta(p_i, \theta) $$
\small 
\begin{multline*} 
$$ logit(p_i) = \beta_1{\textsc{fish}[i]}Above_i  + \beta_2{\textsc{fish}_[i]}Below_i + \beta_3{\textsc{fish}_[i]} Light_i  + \\
\beta_4{\textsc{fish}_[i]} Dark_i $$
\end{multline*}
$$
\begin{bmatrix}
\beta_1{\textsc{fish}}\\
\beta_2{\textsc{fish}} \\
\beta_3{\textsc{fish}} \\
\beta_4{\textsc{fish}} \\
\end{bmatrix} \sim MVNormal \Big(
\begin{bmatrix}
\alpha \\
\beta_1 \\
\beta_2 \\
\beta_3 \\
\beta_4 \\
\end{bmatrix}, S \Big)
$$
$$ \beta_1  \sim Normal(0,1) $$
$$ \beta_2  \sim Normal(0,1) $$
$$ \beta_3  \sim Normal(0,1) $$
$$ \beta_4  \sim Normal(0,1) $$
$$ \sigma_{\textsc{fish}} \sim Exp(1) $$
$$ \theta \sim HalfCauchy(0, 1) $$
$$ \rho_{FISH} \sim LKJcorr(2) $$
&
{\begin{mylist}
m2NC <- map2stan(
  alist(
    #likelihood
    y ~ dbeta2( p, theta ),
    
    # linear model
    logit(p) <- (b_above + ba_fish[fish_id])*above + 
                    (b_below + bb_fish[fish_id])*below + 
                    (b_light + bl_fish[fish_id])*light + 
                    (b_dark + bd_fish[fish_id])*dark,
    
    # adaptive NON-CENTERED priors 
    c(ba_fish, bb_fish, bl_fish, bd_fish)[fish_id] ~ 
       dmvnormNC(sigma_fish, Rho_fish),
    # fixed priors
    c(b_above, b_below, b_light, b_dark) ~ dnorm(0,1),
    theta ~ dcauchy(0,1),
    sigma_fish ~ dexp(1),
    Rho_fish ~ dlkjcorr(2)
  ),
  # data
  data=dlist,
  constraints=list(theta="lower=0"),
  start=list(theta=1), warmup=1000 , iter=1e4 , cores=2 )  \end{mylist}}
\\ % end content row 8
\midrule % In-table horizontal line
\bottomrule % Bottom horizontal line
%\end{tabular}
%\caption{ } % Table caption, can be commented out if no caption is required
\label{tab:template} % A label for referencing this table elsewhere, references are used in text as \ref{label}
\end{longtable}
%\end{table}

\end{document}